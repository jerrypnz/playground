My old CPP code, only for archiving
